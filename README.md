# go-cfg

- サービス間で同一のデータソース（オリジン）を共用するためのパッケージ
- ネットワーク I/O を最小限に抑えるため、ローカルキャッシュと Pub/Sub によるメッセージングを利用


## 想定用途

- マイクロサービス間で共用したい認可処理
  - サービス全体
    - メンテナンス
  - アカウント
    - リフレッシュトークンの取り消し ( [OAuth 2.0 Token Revocation](https://openid-foundation-japan.github.io/rfc7009.ja.html) )
    - 凍結

## アーキテクチャの簡易説明

- 読み取り
  - ローカルキャッシュからデータを取得する
  - ローカルキャッシュに無い場合はオリジンからデータを取得し、ローカルにキャッシュする
- 書き込み
  - オリジンのデータを更新する
  - ローカルキャッシュを更新する
  - 他にオリジンを参照するサービスが変更を検知できるよう、トピックに対してパブリッシュする
- 変更検知
  - 検知用のトピックに従属するサブスクリプションをサブスクライブする
  - オリジンの変更を検知すると、ローカルキャッシュをクリアする

## 代替手法

マイクロサービスの前段にゲートウェイを建てるアーキテクチャでも代替可能
